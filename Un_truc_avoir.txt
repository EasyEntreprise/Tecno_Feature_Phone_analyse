import pandas as pd

# Charger le fichier
df = pd.read_excel("Shop Sales Query New-20250607222823121.xlsx", sheet_name="Shop Sales Query New1")

# Filtrer les lignes où la quantité vendue est égale à 1
df_filtered = df[df["Sales Qty"] == 1]

# Récupérer les shops uniques par mois
shops_par_mois = (
    df_filtered.groupby("Month")["Shop Name"]
    .unique()
    .reset_index()
    .rename(columns={"Shop Name": "Unique Shops with Sales Qty = 1"})
)

# Afficher le résultat
print(shops_par_mois)


# Si tu veux aussi le nombre de ces shops uniques par mois :
shops_par_mois["Count"] = shops_par_mois["Unique Shops with Sales Qty = 1"].apply(len)
